1.1 算法的实现
1.1.1 特征区域的检测
对于音频数字水印而言,我们希望将水印嵌入信号能量较强的位置,这样做有以下优点:
1. 由于信号能量较强,潜入水印的能量可以相应增加,提高水印检测的可靠性。
2. 由于该部分是音频信号的主要部分,对它的恶意攻击如果强度加大,则会破坏信号的品质,因此一定程度上限制了对水印的攻击,进而增强水印的稳健性。
因此,在嵌入水印前,就要检测出这样的特征区域。这个特征区域是一个波峰或波谷,它的长度和高度以及短时幅值之和都需大于一个阙值。这里利用比较比较短时幅值之和求出这些点,作为特征区域的起点。具体的方法如下：
1. 设an为长度为N的音频信号采样序列,其中n=0,1,…,N，由下式分别计算各个样点向前L个点及向后L.个点的短时平均幅度。

Mbn=i=1La(n-i)          forwardMan=i=0La(n+i)             backward                 (4.1)
其中n=L+1,L+2,…,N-L+1， Ma和Mb分别代表前向短时平均幅度和后向短时平均幅度。
2. 利用下式计算样点n前向、后向短时平均幅度改变的比值rn。
rn=Man-MbnMbn=ManMbn-1                (4.2)
3. 计算rn的局部极大值。
若rn同时满足以下三个条件:
rn>rn-1rn>rn+1Man>MTh                              (4.3)
则rn为局部极大值。其中第三个条件中的MTh是短时平均幅度门限值，设置该门限值是为了防止Ma的平均幅度过低而不利于水印的嵌入。对于相邻的两个局部极大值rn1和rn2,如果它们的间隔n1-n2<T，则取其中的较大值为局部极大值。
4. 将所求得的局部极大值所对应的信号样点进行标注，这些点即为检测到的特征区域的起点。也是嵌入水印的起始点。
根据所嵌入的水印的长度,通过调整MTh和T的大小，得出合适的特征点数。


1.1.2 水印的嵌入
在这里本文用图3-5的二值图像作为水印信息。设原水印图像表示为：

W=wi,j,0≤i≤M1,0≤j≤M2                (4.4)

其中为M1, M2为图像的长和高。
水印图像降维后表示为:

V=vk=wi,j,k=M1×i+j,k∈M1×M2          4.5

1. 水印信息的分段
为了提高水印信息在音频信号中的随机性,本文将水印信息进行分段,分段原则使得水印信息段能嵌入到音频信号的DCT的中低频系数里,这样可增加水印的不可感知性和抗击性。设将降维后的一维水印信息分为长度为L的M个等分段,则第m段水印信息表示为:

Vm=vmk,k=0,1,…,Lm                (4.6)

2. 水印信号的嵌入
以检测到的所有特征点为起始点,对原始的音频信号an进行DCT变换。设每帧音频信号长度为N由下式得到DCT域的序列yk。

yk=ak2/Nn=0N-1ancosk2n+1π2N,(K=0,1,2,…,N-1)             (4.7)

其中：

ak=12, k=01, others

由于y0代表信号的直流信息,为防止嵌入水印后的信号产生漂移,对y0不作改变,
接下来进行水印的嵌入：

y'(k)=yk+avk,k=1,2,…, Lmyk,others           (4.8)

其中y'(k)是含有水印的DCT序列, a是大于零比例因子,通过调整a，可以使得水印的能量足够大的同时又保持良好的不可感知性。
对y'(k)进行IDCT变换,得到嵌入水印的音频信号段a'n：

a'n=2/Nk=0N-1aky'kcosk2n+1π2N,(n=0,1,2,…,N-1)

其中

ak=12, k=01, others
将所有的音频段变换完后,用含有水印的音频段a'n代替相应的原音频段,即得到了含水印信息的音频信号。
完整的嵌入流程为下图所示：









原音频信号




水印信息
特征区域检测




水印信息分段
特征区域DCT变换




通过修改DCT系数进行水印嵌入



含水印信息音频段进行IDCT

含水印信息音频信号
用含水印信息音频段替换原音频段


1.1.3 水印的提取
水印在提取时需要原始音频信号的参与,以及水印嵌入时使用的所有参数。得到含有水印的音频信号后,首先对原始音频信号进行特征区域的检测，找到原始信号的特征区域后,根据特征区城的位置确定含有水印的音频信号中水印嵌入的起始位置。对原始音频信号和含有水印信息的音频信号分别进行DCT变换，设原始信号第m帧的DCT系数是ym，含有水印信息音频信号的第m帧DCT系数是ym'，按下式获得第m帧的水印信息vm'：

vm'k=1, if ym'k>ymk 0,else   k=1,2,…,K          (4.10)

重复上述过程,获得所有帧中的水印信息。经过升维等操作恢复二值水印图像。具体的提取水印流程图如下:

含水印的音频信号
原音频信号



特真区域检测

特征区域检测



特征区域DCT变换

特征区域DCT变换




进行升维获得水印图像
通过比较计算获得水印信息


