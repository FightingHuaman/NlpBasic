安史之乱后，吐蕃崛起，占领敦煌60年，同时，汉地传入的大乘佛教与印度传入的密教在吐蕃与其原有的苯教交汇形成藏传佛教。在这吐蕃王朝时期，苯教一直占上风并且还禁止佛教，杀害僧人首领并且关闭寺院。随着吐蕃统治者的被杀和更换，最终还是佛教战胜并且慢慢发展扩大。
在公元851年时，唐朝的张议潮建立了归义军，由此推翻了吐蕃六十年的统治。在这无数的乱战之后，最终变为汉族权政。即使政权一直在更替，可是这并不影响莫高窟的发展。莫高窟的佛教画像反而发扬越来越丰富，因为两代的归义军都信仰佛教。北宋时期政权稳固最久的就是曹氏，共维持了四世一百三十多年，其间经历了五代至北宋景佑年间。曹宗寿是北宋时期的第七任曹氏归义军节度使，当时他把瓜、沙两州各佛寺收藏的经卷文书共约四五万件秘密运送到敦煌，封存在了莫高窟中。以此让莫高窟的佛教发展又得到了很大一步的发展和提升
