攻防对抗下无线传感器网络中的恶意程序传播模型

摘  要：恶意程序传播是无线传感器网络（Wireless Sensor Networks, WSNs）面临的一类重要安全问题。传统的恶意程序传播模型没有考虑攻防过程对恶意程序传播结果的影响。本文从博弈论的角度对WSNs恶意程序传播的微观机理进行分析，建立了WSNs的攻防博弈模型，求出了博弈模型的混合纳什均衡解，并根据博弈双方的混合纳什均衡策略确定恶意程序的传染概率，从而建立了WSNs的恶意程序传播模型。通过对理论模型的分析得到了稳态感染比例与博弈参数之间的关系，并得到了恶意程序长期存在的条件。此外，我们还进一步用元胞自动机方法对WSNs中恶意程序的传播过程进行仿真，仿真结果一方面验证了理论模型，另一方面还发现了节点通信半径的大小和移动行为对恶意程序传播效果的影响，这些研究结果对抑制WSNs恶意程序传播具有理论指导意义。
关键词：无线传感器网络；恶意程序传播；攻防博弈；元胞自动机

1  引言
无线传感器网络（Wireless Sensor Networks, WSNs）是由大量分布在不同位置的传感器节点以无线通信的方式组成的信息传输网络。由于WSNs节点布设方便，组网灵活等特点，目前已经在环境监测、智能交通、森林防火等领域中得到了广泛的应用[1-4]。由于WSNs中节点的资源受限，很容易受到恶意攻击，常见的攻击方式有虫洞攻击[5]、女巫攻击[6-7]、泛洪攻击[8-9]、选择性转发[10-11]、恶意程序传播等多种形式[12-15]。相比其他攻击方式，恶意程序传播是一种影响范围更大、破坏力更强的攻击方式，因为传感器节点一旦被恶意程序感染又会向其他节点发送恶意程序，导致整个网络迅速被恶意程序攻陷。因此，对恶意程序的传播规律及防御措施进行深入研究是一项十分重要的工作。
在WSNs中，当恶意节点向合法节点传播恶意程序时，合法节点通常会利用入侵检测系统(Intrusion Detection System, IDS)对恶意程序进行检测，恶意节点为了不被合法节点发现，不会每次都发送恶意程序，当合法节点的检测频率提高时，它就会降低攻击的频率。而对于合法节点来说，每次利用IDS进行检测都需要消耗一定的能量，为了节约能量，合法节点也不会每次都进行检测，当恶意节点攻击的频率降低时，它也会降低检查频率。因此，恶意节点与合法节点之间的对抗过程其实是一个博弈过程，我们可以用博弈论的方法对WSNs中恶意节点与合法节点之间的攻防策略进行分析。当一个合法节点被恶意程序攻陷时，该节点就变成了恶意节点，并能进一步向其它节点传播恶意程序，该传播过程与传统的传染病的传播过程很相似，因此可以用传染病模型来分析WSNs中的恶意程序传播规律。
至今为止，人们已经分别对WSNs的攻防策略以及恶意程序传播问题做了大量研究。在WSNs的攻防策略方面，Liu等人针对ZigBee网络中协调器节点容易被攻击的问题提出了一种基于演化博弈的自适应协调器节点选择算法[16]，该算法在提高网络通信效率的同时也提高了网络的寿命。Shen等人针对网络节点和恶意程序之间的攻防策略动态变化的特点提出了一个微分博弈模型，相应的防御策略在降低防御成本的同时抑制了恶意程序的传播[17]。Wang等人采用重复博弈的方法来检测恶意节点的攻击行为，相应的防御策略在提高检测率的同时降低了检测能耗[18]。文献[19]提出了一个基于演化博弈的WSNs主动防御模型，对应的防御策略能抑制恶意节点的攻击行为。在文献[20]中，Wang等人无线通信中的恶意干扰问题，建立了干扰器与传感器之间的Stackelberg博弈模型并得到了最优信息传输策略。此外，Li等人利用Stackelberg博弈模型对WSNs中的错误数据注入问题进行了研究[21]，分析了攻防双方的最优策略。Han等人为了节约IDS的能耗，提出了一种基于博弈论和自回归模型的入侵检测模型[22]，该模型不仅可以降低检测能耗，而且可以预测攻击目标。文献[23]和[24]对基于博弈论的网络安全防御问题进行了综述，指出了现有的各种方法的优势和局限性。
在WSNs的恶意程序传播方面，由于恶意程序的传播与传染病的传播很相似，人们很容易将传染病模型应用于网络中恶意程序传播的研究[25-27]。在恶意程序传播过程中，网络中的节点存在易感(S)、感染(I)、恢复(R)三种状态，人们根据三种状态之间的转换关系建立了SIR模型[28]。Wang等人考虑到WSNs中节点能量非常有限，当节点能量耗尽时就会从网络中移除，因此提出了一个iSIRS模型[29]，该模型能有效地描述恶意程序在节点能量消耗情况下的传播过程，此外，他们还进一步研究了节点的休眠-唤醒行为对恶意程序传播过程的影响，得到了恶意程序得以在WSNs中传播的必要条件[30]。文献[31]利用反应-扩散方程研究了WSNs中节点移动情况下的恶意程序传播行为，提出的模型可以有效预测恶意程序随时间的传播范围，这为人们采取针对性的免疫措施提供了指导。文献[32]和[33]针对通信半径和节点分布密度对WSNs中恶意程序传播的影响提出了一个改进的SIRS模型，得到了恶意程序在网络中得以持续传播的必要条件。文献[34]针对移动无线传感器网络(MWSN)中恶意程序的传播问题提出了一个含有移动补丁的传播模型，发现移动补丁可以大大降低防御成本。文献[35]利用传染病理论和马尔科夫链方法对异质WSNs中的恶意程序传播问题进行了研究，发现网络的可用性与节点的度分布及脆弱性分布有关。为了研究僵尸网络在物联网中形成的动力学过程，Acarali等人建立了一个基于物联网的SIS病毒传播模型，发现节点的分布密度和能量限制对僵尸网络生成过程具有影响[36]。
尽管以上工作已经对WSNs的攻防策略及恶意程序传播这两个方面的问题做了大量研究，但是至今为止，这两方面的工作都是独立开展的，研究者在对这两个问题进行研究时没有考虑它们之间的联系，然而，实际上攻防博弈策略的选择和恶意程序的传播过程是紧密联系的，例如，攻防双方所采取的博弈策略会影响恶意程序的传播结果，因为当恶意节点对合法节点发起攻击时，合法节点通常会采取一定的防御措施，这会影响恶意节点的攻击频率和攻击成功率，从而影响恶意程序的传播结果。基于这个原因，本文将攻防博弈策略与WSNs中恶意程序的传播模型耦合起来，研究攻防博弈行为对恶意程序传播结果的影响。
本文的主要研究内容如下：首先，建立了恶意节点与合法节点之间的博弈模型，并求出了该模型的博弈均衡策略，其次，基于攻防双方的博弈均衡策略建立了WSNs的恶意程序传播模型，并求出了该传播模型的解析解，从而得到了感染比例随时间的演化情况。最后，用元胞自动机方法对本文的模型进行了仿真，仿真结果进一步验证了理论结果。本文的主要贡献如下：(1)将攻防博弈过程与恶意程序的传播过程耦合起来，通过建立与求解耦合模型，得到了稳态感染比例与博弈参数之间的关系，从而可以通过控制博弈参数来控制感染节点的规模；(2)通过分析稳态感染比例与博弈参数之间的关系，得到了网络中恶意程序得以长期存在的条件，从而有望通过控制博弈参数来消灭网络中的恶意程序。(3)通过元胞自动机仿真，发现节点的移动以及通信半径的增加能加速恶意程序的传播，因此，限制节点的移动或适当减小通信半径能降低恶意程序的传播速度。
本文后续的内容安排如下：（1）建立并求解WSNs的攻防博弈模型；（2）建立并求解WSNs的恶意程序传播模型（3）博弈及传播模型的数值模拟及仿真；（4）结论。
2   WSNs的攻防博弈模型
WSNs由恶意节点与合法节点组成，其中恶意节点会向合法节点传播恶意程序，合法节点能够利用IDS对接收的信息进行检测。恶意节点为了掩饰自己的攻击行为也会给合法节点发送正常信息。合法节点对收到的信息进行检测需要消耗一定的能量，由于无线传感器节点由电池供电，如果合法节点对收到的所有信息都进行检测，则很快会因能量耗尽而无法工作。因此，合法节点在决定是否进行检测时需要综合考虑其付出的能耗代价及被攻击的可能性。由此可见，恶意节点与合法节点之间的攻防行为其实是一个博弈过程，攻防双方会在分析博弈局势的基础上采取对自己最有利的策略。因此，本文用博弈论的方法对攻防双方的策略进行分析。
定义1 WSNs中恶意节点与合法节点之间的攻防博弈模型可以表示为一个三元组，其中：
① N为博弈的参与者集合，对于本文来说，。
② Si为参与者可采取的策略集合，当i为合法节点时，，当i为恶意节点时，，需要特别指出的是，这里的不攻击策略并不是指恶意节点不发送任何信息，而是指其发送正常信息。
③ ui为参与者i在博弈过程中获得的收益，ui的值由博弈双方所采取的策略决定。表1给出了本文用到的一些符号的定义，表2给出了博弈双方的收益矩阵。
表1 符号定义
符号
含义

合法节点检测到恶意程序获得的收益，恶意节点被识别造成的损失。

恶意节点攻击成功带来的收益，合法节点感染恶意程序造成的损失。

合法节点对收到的信息进行检测所需的能量代价。

恶意节点发送恶意程序或正常信息所消耗的能量代价。

恶意节点进行攻击的概率。

合法节点进行检测的概率。

合法节点在攻防博弈中的期望收益。
 
恶意节点在攻防博弈中的期望收益。
表2 合法节点与恶意节点的博弈收益函数表
合法节点
恶意节点
攻击
不攻击
检测
, 
, 
不检测
,    
,  



在攻防对抗过程中，恶意节点向其他节点发送信息（恶意程序或正常信息）需要消耗代价为的能量，合法节点对收到的信息进行检测需要消耗代价为的能量，当恶意节点向合法节点发起攻击，合法节点又正好进行检测时，合法节点会因成功检测出恶意程序而获得价值为a的收益，恶意节点则会因暴露身份而造成代价为a的损失。当恶意节点发起攻击，而合法节点不进行检测时，恶意节点会因成功传播恶意程序获得价值为b的收益，而合法节点则会因感染恶意程序造成代价为b的损失。另外，为了使博弈有意义，模型须满足及这两个条件。
由表2可知，若恶意节点发起攻击，合法节点就应该进行检测，反之，合法节点就不应该检测；而对恶意节点来说，若合法节点进行开启检测，它就不应该进行攻击，反之，就应该发起攻击。由此可见，上述博弈模型不存在纯策略纳什均衡解，下面从混合均衡策略的角度分析博弈双方的攻防行为。
定理1  由定义1建立的WSNs攻防博弈模型存在混合纳什均衡策略。
证明：假设恶意节点以概率进行攻击（传播恶意程序），以概率不进行攻击（传播正常信息），合法节点以概率进行检测，以概率不进行检测，则根据收益矩阵，合法节点的期望收益为：
                            (1)
恶意节点的期望收益为:
            (2)
令，得：
	                          (3)
整理上式得：  	                                                                                         (4)
当时， ，合法节点进行检测的期望收益等于不进行检测的期望收益；
当时， ，合法节点进行检测的期望收益大于不进行检测的期望收益；
当时， ，合法进行检测的期望收益低于不进行检测的期望收益。
同理，     令， 得	 	 (5)
整理上式得：	                                                                                                       (6)
当时，，恶意节点发起攻击的期望收益等于不攻击的期望收益；
当时，，恶意节点发起攻击的期望收益低于不攻击的期望收益；
当时，，恶意节点发起攻击的期望收益高于不攻击的期望收益。
由以上分析可知，合法节点会根据恶意节点的攻击概率决定是否进行检测，而恶意节点也应该根据合法节点进行检测的概率决定是否发起攻击，便是恶意节点与合法节点进行攻防博弈的混合纳什均衡策略。证毕。
定理1表明，当恶意节点的攻击概率大于时，合法节点就会采取检测策略，这会使合法节点的检测概率增加。当检测概率大于时，恶意节点就会采取不攻击策略，这又会使恶意节点的攻击概率降低。当攻击概率小于时，合法节点就会采取不检测策略，从而使检测概率降低。当检测概率小于时，恶意节点又会采取攻击策略，因此恶意节点与合法节点的策略会在均衡策略附近作小幅交替波动，但平均来看，合法节点的检测概率是，而恶意节点的攻击概率是。 
 3  博弈驱动下的WSNs恶意程序传播模型
由WSNs的攻防博弈模型可知，当恶意节点向合法节点发起攻击时，若合法节点不进行检测就会被恶意节点感染，反之，合法节点就能阻止恶意节点的攻击，并清除恶意程序使恶意节点变为合法节点。另外，考虑到传感器节点的能量有限，当节点的能量耗尽时就会从网络中移除（变为死亡节点），同时，为了保证网络的功能不受影响，人们也会向网络中加入一定数目的新节点，使网络中的总节点数保持不变。网络中各种节点之间的状态转换关系如图1所示。其中S表示合法节点，I表示恶意节点，D表示死亡节点，在WSNs的运行过程中，合法节点会以概率被感染，恶意节点会以概率被修复，合法节点和恶意节点会因能量耗尽分别以概率和移除出系统，同时系统会以速率加入新的合法节点，N为网络中合法节点及恶意节点的总数，其中恶意节点个数为NI，占总节点数的比例为i，合法节点个数为NS，占总节点数的比例为s。假设每个恶意节点每次只能选择一个合法节点进行攻击，则系统的演化过程可以用微分方程组（7）进行描述。

图1 WSNs节点状态的转换关系
                            (7)
方程组两边同时除以N得: 
                                            (8)
于是有：
                                               (9)
即
                                                (10)
对方程(10)两边同时进行积分并整理得：
                                 (11)
进一步整理得：
                                             (12)
设t=0时恶意节点的比例为i0，则有：
                                                       (13)
令，对方程(12)进行求解得：
                                                       (14)
 因此有：
                                                            (15)
对式(15)进行分析可知：
当时，若，则；
若，则。
因此，当时，网络中恶意节点的比例会达到(16)式所示的稳定值:
                                                (16)
由上一节的分析可知，恶意节点与合法节点作为理性的智能体，会采用混合纳什均衡策略作为各自的攻防策略，即恶意节点会以概率进行攻击，而合法节点会以概率进行检测，当恶意节点发起攻击而合法节点不进行检测时，合法节点就会被感染，因此合法节点被感染的概率为，当恶意节点发起攻击而合法节点进行检测时，恶意节点就会被修复，因此，恶意节点的恢复概率为。将代入微分方程组(8)便得到含博弈参数的微分方程组(17)：
                       (17)
其对应的稳态感染比例如(18)式所示：
                             (18)
由以上分析可知，WSNs中恶意程序最终的感染比例由博弈双方所采取的策略有关，而该策略又是由收益矩阵中的参数决定的，因此最终网络中恶意节点所占的比例由博弈双方的收益参数决定。另外，式(18)也揭示了网络中恶意程序长期存在的条件。
4  数值模拟与仿真
4.1  攻防博弈策略数值模拟
令，，，，此时，，。分别对公式（1）和公式（2）进行数值模拟，结果如图2和图3所示。从图2可以看出，当时，合法节点的期望收益不随的变化而改变，此时合法节点的期望收益与其采取哪种策略无关；当时，合法节点的期望收益随着的增大而增加，此时合法节点应该采取检测策略；而当时，合法节点的期望收益随着的增大而减少，此时合法节点应该采取不检测策略。从图3可以看出，当时，恶意节点的期望收益不随的变化而改变，此时恶意节点的收益与其采取哪种策略无关；当时，恶意节点的期望收益随着的增加而减少，此时恶意节点应该采取不攻击策略；而当时，恶意节点的期望收益随着的增加而增大，此时恶意节点应该采取攻击策略，这与前面的理论分析一致。

图2博弈双方策略的变化对合法节点期望收益的影响

图3博弈双方策略的变化对恶意节点期望收益的影响
4.2恶意程序传播数值模拟
根据前面建立的WSNs恶意程序传播模型，对微分方程组(17)进行数值模拟，便可得到收益参数与稳态感染比例之间的关系，模拟结果如图4至图6所示，从图中可以看到，在给定参数下，网络中恶意节点的比例随着时间的演化最终会达到一个稳定值。
从图4可以看出，恶意程序的传播速度和稳态感染比例会随a（合法节点识别恶意程序的收益或恶意节点被识别遭受的损失）的减小而变小，当a小于一定值（图4对应的值为2.17）时稳态感染比例的值为0，这意味着恶意程序将会从网络中消失。这是因为当恶意节点被识别遭受的损失减小时，它会加大攻击概率，与此同时，合法节点也会加大检测概率，这使得恶意节点被识别并治愈的概率变大，从而导致传播速度和稳态感染比例变小。
从图5可以看出，恶意程序的传播速度和稳态感染比例会随b（合法节点遭受攻击后的损失或恶意节点攻击成功时的收益）的增大而变小，当b大于一定值（图5对应的值为3.45）时稳态感染比例的值为0，此时恶意程序也会从网络中消失。这是因为当合法节点遭受攻击的损失变大时，其会加强防御（增大检测概率），迫使恶意节点降低攻击概率，这使得恶意程序的传播速度变小，从而导致稳态感染比例变小。
从图6可以看出，恶意程序的传播速度和稳态感染比例会随eS（合法节点的检测能耗）的增大而变大，这是因为当检测能耗eS增大时，合法节点保持检测概率不变，而恶意节点提高了攻击概率（由博弈模型的纳什均衡策略决定），这使得合法节点被感染的概率增大，恶意程序的传播速度也随之增加，从而导致稳态感染比例增大。
为了进一步展示稳态感染比例与博弈参数之间的关系，我们根据公式(18)得到了稳态感染比例I与博弈参数a和b之间的相位图（图7）。从图中可以更清楚地看到：当参数a和b处于某个特定范围时，节点的感染比例为0，恶意程序最终会从网络中消失，而当参数a和b处于其它范围时，恶意程序会一直存在下去，并能使保持一定的节点感染比例。

图4成功检测出恶意程序的收益对稳态感染比例的影响（）

图5 合法节点被感染恶意程序的损失对稳态感染比例的影响（）

图6 合法节点的检测能耗对稳态感染比例的影响（）

图7 稳态感染比例随博弈参数a和b变化的相位图()

4.3恶意程序传播的元胞自动机仿真
前面用微分方程组建立的恶意程序传播模型依赖一个假设条件——网络是全连接的，即网络中的任意两个节点之间都可以直接通信。然而，对于真实的WSNs来说，由于节点的发射功率与传输距离的平方成正比，传感器为了节约能量，只会与其附近的部分节点进行直接通信。因此，前面的理论模型是在理想条件下建立的，与真实情况存在差异，为了更精确地研究WSNs中恶意程序的传播规律，同时也为了对前面的理论研究结果进行验证，本节用元胞自动机方法对WSNs中的恶意程序传播过程进行仿真。
4.3.1仿真算法
步骤1：生成一个如图8所示的规格为100×100的网格，随机选择比例为pw的格子布设传感器节点.
步骤2：每个传感器节点与距离自己半径不超过r的节点产生连边（组网），由此生成传感器网络。
步骤3：在初始时刻t0=0，随机选取比例为i0的节点设置为恶意节点。
步骤4：每个恶意节点在自己的邻居节点（可以与其直接通信的节点）中随机选择一个节点发送信息，其中发送恶意信息的概率为x*，发送正常信息的概率为1-x*。
步骤5：若恶意节点选中的节点也是恶意节点，则信息会被直接丢弃。反之，若恶意节点选中的是合法节点，则合法节点会以概率y*对收到的信息进行检测，以概率1-y*不对信息进行检测。当合法节点接收的是恶意程序且正好没有进行检测时则会被感染，反之，若合法节点实施了检测，则会清除恶意节点中的恶意程序，使其恢复为正常节点。
步骤6：每个时刻合法节点和恶意节点会分别以概率和因能量耗尽而排除出系统，同时，系统会增加同等数目的新的合法节点。
步骤7：若t小于预设的模拟步数，则t的值增加1，并转入步骤4继续执行，否则，结束运行。

图8无线传感器节点分布图（灰色为正常节点，黑色为恶意节点）
4.3.2仿真结果
设定参数pw=0.15，i0=0.05，执行上述模拟步骤，考查不同博弈参数下WSNs恶意程序的传播速度及系统的稳态感染比例。图9、图10和图11分别显示了博弈参数a、b、eS对恶意程序的传播速度及稳态感染比例的影响。从图中可以看出，恶意程序的传播速度及系统的稳态感染比例随着博弈参数a与eS的增大而变大，随着博弈参数b的增大而变小，这与数值模拟的结论一致。值得注意的是，我们发现仿真时的传播速度要小于同等参数条件下数值模拟的传播速度，这主要是因为仿真时节点的通信半径受到限制导致的。
考虑到WSNs中恶意程序的传播过程与通信半径有关，因此，我们进一步研究了传感器节点的通信半径对恶意程序传播速度的影响，在模拟过程中通过修改通信半径的值，得到了不同通信半径下恶意程序的传播曲线，从图12可以看出，在其他参数固定的情况下，恶意程序的传播速度随着通信半径的增加而增大。
在某些应用领域中（如军事侦察领域），传感器节点在工作时会不断移动位置，为了考察节点的移动行为对恶意程序传播速度的影响，我们进一步对移动环境下WSNs的恶意程序传播过程进行了仿真，仿真步骤与静态传播的步骤基本一致，只需在步骤5后面增加一个步骤，使每个传感器节点在每个时步随机选择一个方向移动一格（前提是目标位置没有被其它节点占据）。仿真结果如图13所示，从图中可以看出，在同等参数条件下，移动无线传感器网络中恶意程序的传播速度要高于静态无线传感器网络，其原因分析如下：在静止状态下，恶意节点只能选择其附近的节点进行传播，随着时间的推移，就会导致大量恶意节点聚集成簇，这种聚集效应会降低恶意程序的传播速度；而在移动状态下，恶意节点能够与合法节点充分混合，降低成簇效应，从而提高传播速度。

图9成功检测出恶意程序的收益对稳态感染比例的影响（）

图10合法节点被感染恶意程序的损失对稳态感染比例的影响（）

图11 合法节点的检测能耗对稳态感染比例的影响（）


图12通信半径对恶意程序传播速度的影响（）

图13节点移动对恶意程序传播速度的影响（）

5  结论
本文从博弈论的角度对WSNs中的攻防博弈策略进行了分析，求出了博弈模型的混合纳什均衡策略，并对均衡策略驱动下的WSNs恶意程序的传播过程进行了研究。我们分别从理论建模和元胞自动机仿真两个角度对恶意程序的传播过程进行研究，得到了恶意程序的稳态感染比例与博弈参数之间的关系，并发现节点通信半径的增大及节点的移动行为能加快恶意程序的传播速度。研究结果对制定措施抑制WSNs中的恶意程序传播具有一定理论指导作用。具体措施可以如下：（1）优化合法节点的检测算法，节约其在信息检测过程中消耗的能量；（2）在不影响网络功能的情况下适当减小传感器节点的通信半径，这一方面可以降低恶意程序的传播速度，另一方面也可以节约传感器节点的能耗，延长其使用寿命。
