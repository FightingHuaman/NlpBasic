	
	
基于DC-YOLO模型的建筑物砌体构件危险性等级鉴定方法
张洪瑞１　卫文学1  肖新光1 车吉鑫1  邵婉露1   刘恒泉1   杨松1
１(山东科技大学计算机科学与工程学院　山东 青岛 266590) 
摘 要   为了提高房屋危险性等级鉴定工作的效率，避免人为干预，使鉴定结果更客观，设计了DC-YOLO模型。该模型是将深度学习与目标检测算法结合，设计的一种砌体构件危险性等级自动化鉴定方法。主要工作包括：（1）采用K-means聚类获得最佳先验框数量和尺寸。（2）扩大网格尺寸以提高对小目标的识别能力。（3）引入可变形卷积，以适应砌体构件裂缝形状不规则的特点。实验结果表明，DC-YOLO模型与常规方法比较，对各类目标的识别率均有不同程度的提高，精确率、召回率、F1值均达到了较好的效果，对于建筑物砌体构件危险性等级有较好的分类性能。
关键词 深度学习　砌体构件　危险性等级鉴定  可变形卷积
中图分类号  TP399　　　　文献标识码  A 　　　　DOI: 



0  引　言
危房鉴定与改造一直是国家和政府关心的问题，房屋安全事关生命财产安全，必须引起足够重视。为准确客观判断房屋的危险程度，确保其结构安全，政府出台了《危险房屋鉴定标准》，构件危险性鉴定是房屋基础及上部结构危险性鉴定的第一步[1][2]。目前为止，房屋的危险性等级鉴定还没有建立像人脸识别、手写字体识别一样的公共数据库，没用相应的软件支持构件以及房屋危险性鉴定，鉴定过程需要亲自观察，根据经验和相关规定等得出结论，这样既存在很大的主观因素，也给相关实验工作的可比性带来巨大困难，因此提出一个操作简便、客观性强的房屋构件危险性鉴定方法对于准确掌握房屋现状、有效应对自然灾害、危房改造等都是十分有意义的。
收稿日期: xxxx-xx-xx。国家重点研发计划(2016YFC0801408)。张洪瑞，硕士研究生，主研领域：深度学习，物联网技术。卫文学（通讯作者），副教授/博士。车吉鑫，硕士研究生。邵婉露，硕士研究生。
近年来随着国家对于民生问题的重视，许多学者致力于房屋危险性鉴定的工作。杨建江和张永超提出的基于层次分析法和模糊理论的危险房屋鉴定方法，采用加权平均型数学模型，用非对称贴近度法划分房屋等级[3]；芦白茹等提出的基于层次分析法和熵权法组合权重对混凝土结构危险房屋多层次模糊综合评定方法，通过多层次模糊综合评价，对钢筋混凝土结构建筑做出量化评定[4]；苏炜、汪菁等利用集对分析理论，对建筑完损状况及其评价等级进行同异反分析，确定建筑完损状况的评价等级[5]。以上方法虽然可以用数学方法对建筑物进行危险性鉴定，但在执行过程中，可操作性不强，要求鉴定人员具备一定的科学知识和鉴定经验[6][7]。另一类方法就是传统的经验鉴定法，此类方法含有很大的主观因素，采用相关仪器设备，通过某些结构的受力获得相关数据，过程繁琐，大量人力物力投入，不适合中国现在大量异地搬迁和房屋改造的现状[8][9]。
针对于现有方法可操作不高，过程复杂且主观性太强等问题，本文设计了一种DC-YOLO模型，将目标检测算法与房屋检测结合，采用K-means聚类获得最佳先验框，引入可变形卷积适应构件裂缝不规则的特点，扩大网格尺寸以更好地识别小目标，提取《危险房屋鉴定标准》中对于砌体结构构件危险性鉴定的关键要素进行实验，更细致地把构件危险性分为四个等级，更有针对性地对房屋危险性进行鉴定。 
1 理论基础
1.1 目标检测模型YOLO
YOLO(You only look once: unified, real-time object detection)[10]是一种基于回归的目标识别算法，相比于之前的几代，YOLOV3识别速度快，只需要做一遍前向预算就能实现目标检测，识别率大大提高[11][12]。YOLOV3使用了多尺度预测且加入了残差网络模块，因此它对小目标的检出率大幅度提高。模型使用3*3卷积层提取特征，用1*1卷积层减少计算量[13][14]。
YOLO将输入图像分成S*S个单元格，单元格借助于anchor boxes进行边界框的预测。YOLOV3针对于COCO数据集和VOC数据集都根据数据集特点采用了3个尺度进行目标检测，每一个尺度都有3个an-chor boxes。边界框的信息采用五元组T（x,y,w,h,c）表示，x，y表示边界框的横坐标与纵坐标，w，h表示其宽度和高度，c是置信度，它反应当前边界框是否包含预测目标及其预测准确性的估计概率，其计算公式为公式（1）所示。
                             （1）
其中PO 表示边界框包含预测目标的概率，PIOU表示边界框与真实目标区域的重叠面积。当边界框包含预测目标时，PO=1，否则PO=0。若单元格中包含多个边界框，则取重叠面积最大的。
1.2 可变形卷积网络
传统的卷积神经网络存在一个主要难点就是如何让网络适应目标的几何形变，针对于此问题arXiv[15]等人提出了可变形卷积，在传统的卷积神经网络基础上引入了学习空间几何形变的能力，即可变形卷积网络[16][17]。
可变形卷积的主要思想是在传统卷积神经网络中对感受野进行改进，由原来长方形或者正方形的变成不规则的感受野，更符合实际情况的需要。引入的可变形卷积核可以根据待检测的目标提取特征，提取目标的轮廓不是标准的矩形，而是以目标的大体轮廓作为卷积核的边界框，这样可以最大程度得保留待检测目标的特征，不会因为边界框的形状而造成物体特征信息的丢失或损失。
2 DC-YOLO模型
裂缝本身固有属性强，裂缝是不规则的矩形，由于墙体损坏程度不同向各个方向延伸，直接用固定的方块型卷积提取其特征会使卷积层中的几何变换能力低效，从而使得识别率降低，数据集中存在一定比例的小目标，裂缝大小不同，对网络的精确性要求高。
DC-YOLO是在YOLOV3的基础上提出的模型，找到最佳先验框，扩大网格尺寸，提高对小目标的检测能力，引入可变形卷积，使得卷积核的形状适应目标轮廓形状，解决传统模型难以适应目标特点的问题。
2.1 DC-YOLO结构
DC-YOLO模型结构如图1所示，它将整个图像作为输入，同时输出检测到砌体构件的裂缝及其类别，
ClassA， ClassB，ClassC，ClassD。将输入图像划分成S*S个单元格，每个单元格负责落入该单元格的物体，单元格借助于anchor boxs进行边界框的预测，在13*13、26*26、52*52三个尺度上进行检测且采用2倍的上采样使得特征图在相邻尺度上传递。模型包含27个卷积层、一个全连接层和一个Softmax分类层，设置池化层用以保存原始图片信息。全连接层输出维度计算为S*S*(2*5+C)， C表示类别数，结合本实验数据集，C取4，因此输出为1134维的张量，最后由softmax实现分类功能。

图1 模型结构图
其中，对于3*3的卷积核，如图2所示。




图2 可变形卷积
3*3卷积核表示为：
R={（-1，-1），（-1，0），……. ，（0，1），（1，1）}
对于卷积核权重为w，输入特征图为x，输出特征图为y的p0点，传统卷积的数学表示为公式（2）。
         （2）
其中，pn表示在区域R的任一位置。
DC-YOLO所使用的3*3卷积核，在普通卷积的基础上引入了一个可以学习特征的位置偏移量rpn，为公式（3）所示。
        （3）
其中，rpn可表示为：{rpn |n=1,……,N}，N∈R
由于采样是在不规则的区域中进行，会使得偏离层特征点位置不连续，因此采用双线性插值的方法把任意位置的输出转化为连续的。因此对公式（3）使用双线性插值实现如公式（4）。
                   （4）
其中，p表示离散的采样点，q为双线性插值之后的连续点集。
砌体构件裂缝，存在以下特点：存在一定比例的小目标，以中尺度大小的目标巨多，检测目标为不同大小向不同方向延伸的的裂缝，形状不规则，对于网络的精确性要求高。经过实验发现，网格尺寸的大小对于小目标的检出率影响很大，DC-YOLO模型在多层卷积之后加入了一个18*18的网格，扩大后的网格尺寸，提高了对小目标的识别能力，同时增加了整个网络的准确性，可以在同等条件下检出更精细的目标，之后再通过设置两个9*9的网络，在进一步提取特征的同时又辅以1*1卷积层来减少特征空间和计算量。
2.2 DC-YOLO结构
针对墙缝的特点，结合先验框数量与平均交并比（IOU）的关系，如图3所示，使用K-means聚类[18][19]方法获得最佳先验框。K-means聚类的自定义距离度量公式如公式（5）所示，选用box与聚类中心box之间的IOU值作为距离指标。                           （5）

图3先验框与平均交并比的关系
从图表中可以看出，当boxs的数量为9时，平均交并比便不再上升，所以取9个先验框，分别为（10*13）、（13*15）、（16*25）、（30*61）、（50*64）、（65*110）、（115*87）、（155*189）、（367*345），考虑到数据集中中等大小的特征较多，在设置时，侧重于中尺度的先验框大小。采用3个尺度进行检测，在每个尺度上的每个单元格借助3个先验框预测3个边界框。
2.3 损失函数定义
DC-YOLO使用了均方和误差作为损失函数，由三部分组成：坐标误差、IOU误差和分类误差，公式如公式（6）所示。
    （6）
 表示坐标误差，其具体的计算方法如公式（7）所示。
 （7）
其中，S代表特征图的网格尺寸，B代表每个单元格的预测框个数， 表示坐标误差的权重系数， xi 、yi、wi、hi分别表示单元格i所预测的物体中心点的横坐标与纵坐标以及预测框的宽度和高度，而、、、则分别表示了单元格i的真实滑动窗口的中心点横坐标与纵坐标及其宽度和高度，表示目标落入单元格i的第j个预测框中。
表示IOU误差，其具体计算方法如公式（8）所示。
    （8）
其中，表示IOU误差的权重，ci与分别表示预测框的单元格i的置信度值和真实的置信度值，表示目标没有落入单元格i的第j个预测框中。
 表示分类误差，其具体的计算方法如公式（9）所示。
         （9）
  其中，与预测的与真实的滑动窗口中单元格i包含第c类目标的条件概率。
3 实验与结果
由于房屋检测没有公开数据库，因此本文实验所用数据均是课题组采集的数据，如图4所示。

图4数据集展示
3.1 数据标注
选取了现在砌体结构危险房屋普遍存在的几个特征作为实验的标注依据，分别是：承重墙或柱因受压产生缝宽大于1.0mm、缝长超过层高1/2的竖向裂缝；承重墙或柱产生超过层高1/3的多条竖向裂缝；墙或柱因偏心受压产生水平裂缝；相邻构件连接处断裂成通缝。
有害裂缝是指继续发展可能会影响结构性能、使用功能和耐久性的裂缝，对于砌体结构的有害裂缝宽度，我国没有明确规定，参考《房屋鉴定标准》中对于墙体裂缝宽度的描述，选取1mm作为等级划分的界限，认为裂缝超过1mm为有害裂缝，根据实地调研情况，实验新增加5mm的划分界限。
结合国家对于房屋构件的要求和本次实验等级划分要求，制定了以下4个级别：
1、Class A：无危险点
2、Class B：有危险点，一般是缝宽小于1mm的单条水平缝或竖向缝且缝长低于层高1/3，不影响构件主体安全 
3、Class C：局部危险，存在以上四个特征中的一个特征但缝宽均小于5mm
4、Class D：整体危险，存在以上四个特征中的两个及以上特征或存在宽大于5mm的裂缝，构件已不能满足安全使用要求，存在坍塌风险
实验数据集包括训练集2040张，测试集400张，使用开源工具labelimg对数据进行标注，标注的特征为以上四个等级。
3.2 评价标准
实验选取精确率、召回率和F1值作为评价网络性能的标准，具体定义如下：
精确率（Precision）表示分为某类的图片中实际为某类的比例，该值可以反映对某类分类正确性的判断能力。
召回率（Recall）表示正确检测的某类与测试集中存在的某类的比率，该值可以反映网络对某类查准能力的大小。
F1值是统计学中用来衡量分类模型精确度的指标，它同时兼顾了精确率和召回率，可以看作是二者的一种加权平均，计算公式如(10)。
                        （10）
3.3 实验结果
实验配置如表1所示
表1 实验相关配置
名称
配置
操作系统
CentOS 7.5
中央处理器/GHz
Intel(R) Xeon(R) E5-2690 v4 @ 2.60GHz
内存/GB
500G
GPU
 NVIDIA-SMI 390.77           
深度学习框架
Darknet

网络训练时参数如下：batch为64，max_batches为15000，采用变学习率的优化方法Adam，前13000次采用的初始学习率为0.001，后2000次的学习率为0.0001，为更准确地获取最佳模型，设置训练时每1000次迭代保存一次网络的权重文件。
表2-表5显示了YOLO[10]、YOLOV2[20]、YOLOV3[21]、SSD512[22][23]与本文的DC-YOLO模型的分类结果，这些方法均在本实验数据集上进行了训练与测试。从表中可以看出DC-YOLO模型对各类的分类精确率均达到了0.9以上，召回率均达到了0.87以上，
F1值达到了0.9左右，与其他方法相比，都有不同程度的提高。
DC-YOLO模型随着迭代次数的增加，类别准确率逐渐接近于1，总损失值下降到约0.026941，平均损失值下降到约0.033607avg，所得结果如图5。

图5 DC-YOLO实验结果图
同时，在同一阈值下，DC-YOLO分类准确率高。YOLO、YOLOV2、YOLOV3、SSD512在检测时不同程度地出现漏检、重复检测等问题，DC-YOLO提高了对目标的识别率，减少了漏检、重复检测等问题的出现，截取一部分如图6、7所示。
图6 传统方法出现的问题

图7 DC-YOLO检测结果
4 结 语
本文提出了DC-YOLO模型以完成对建筑物砌体构件的危险性等级自动化鉴定。本文模型采取三种策略：扩大网格尺寸以更高效地检测出小目标，利用K-means聚类获取最佳先验框，引入可变形卷积学习构件裂缝形变信息。实验结果表明，模型可以很好得识别数据集中的目标，与传统单一模型相比，取得了较高的分类准确率。对下一步实现危房整体危险性的鉴定奠定了一定的基础，具有很大的现实意义。











参 考 文 献 
[1] 胡国庆.房屋危险性鉴定时的注意事项[J].建筑结构,2015,45(09):11-13.
[2] 陈平宁.《危险房屋鉴定标准》(JGJ125—99)若干问题探讨[J].建筑结构,2002(11):71-73.
[3] 杨建江,张永超.模糊层次分析法和模糊理论在危险房屋鉴定中的应用[J].河北工业大学学报,2005(06):91-95.
[4] 芦白茹. 基于AHP法和熵权法组合权重对RC结构危险房屋多层次模糊综合评定研究[A] 中国力学学会工程力学编辑部,2016:11.
[5] 苏炜,汪菁.工业建筑方案属性层次综合优选方法[J].工业建筑,2004(08):14-16+18.
[6] 王天坤. 既有砌体结构可靠性鉴定与分析[D].安徽理工大学,2018.
[7] 徐建,梁建国,石柳,曹雪生.我国砌体结构发展的若干问题探讨[J].建筑结构,2016,46(15):91-97.
[8] 高小小. 基于深度学习的混凝土桥梁裂缝检测与分类[D].陕西师范大学,2018.
[9] 王丽苹. 基于深度学习的混凝土路面裂缝检测[D].河北工程大学,2018.
[10] Joesph R, Santosh D. YOLO: Real-Time Object Detection[Online], available: http://pjreddie.com/darknet, November 3, 2016
[11] 蔡成涛,吴科君,刘秋飞,程海涛,马强.基于改进YOLO算法的全景多目标实时检测[J].计算机工程与设计,2018,39(10):3259-3264+3271.
[12] 周飞燕,金林鹏,董军.卷积神经网络研究综述[J].计算机学报,2017,40(06):1229-1251.
[13] 施辉,陈先桥,杨英.改进YOLO v3的安全帽佩戴检测方法[J/OL].计算机工程与应用:1-9[2019-03-29].http://kns.cnki.net/kcms/detail/11.2127.TP.20190311.1538.012.html.
[14] 杨观赐,杨静,苏志东,陈占杰.改进的YOLO特征提取算法及其在服务机器人隐私情境检测中的应用[J].自动化学报,2018,44(12):2238-2249.
[15] DAI Jifeng, QI Haozhi, XIONG Yunwen, et al. Deformable convolutional networks[OL].http://arxiv.org/abs/1703.06211.2017.
[16] 高鑫,李慧,张义,闫梦龙,张宗朔,孙显,孙皓,于泓峰.基于可变形卷积神经网络的遥感影像密集区域车辆检测方法[J].电子与信息学报,2018,40(12):2812-2819.
[17] 徐国晟,张伟伟,吴训成,苏金亚,郭增高.基于卷积神经网络的车道线语义分割算法[J].电子测量与仪器学报,2018,32(07):89-94.
[18] 郭占元, 林涛.面向大规模数据快速聚类K-means算法的研究[J].计算机应用与软件, 2017, 34 (5) :43-7, 53.
[19] 郑志强,刘妍妍,潘长城,李国宁.改进YOLO V3遥感图像飞机识别应用[J/OL].电光与控制:1-6[2019-03-31].http://kns.cnki.net/kcms/detail/41.1227.TN.20180823.1037.002.html.
[20] 魏湧明,全吉成,侯宇青阳.基于YOLO v2的无人机航拍图像定位研究[J].激光与光电子学进展,2017,54(11):101-110.
[21] 张富凯,杨峰,李策.基于改进YOLOv3的快速车辆检测方法[J].计算机工程与应用,2019,55(02):12-20.
[22] 陈幻杰,王琦琦,杨国威,韩佳林,尹成娟,陈隽,王以忠.多尺度卷积特征融合的SSD目标检测算法[J/OL].计算机科学与探索:1-15[2019-04-03].http://kns.cnki.net/kcms/detail/11.5602.tp.20190118.1125.008.html.
[23] 谢铮桂.基于改进的卷积神经网络的手势识别的研究[J].计算机应用与软件,2019(03):192-195+281.


	计算机应用与软件	7


