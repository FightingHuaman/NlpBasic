无线传感网络中基于数据属性空间索引的查询
　　针对当前无线传感器网络(WSN)中数据查询通信开销大而带宽资源有限的问题，提出了一种基于局部聚类的数据存储模型。该模型通过将整个网络按地理位置划分区域，采用局部数据聚集存储，避免了将同种数据发送至一个存储点存储所造成的巨大通信开销，从而均衡通信带宽。在数据存储模型之上，提出了一种基于空间索引的数据查询方法(SIQ)。在SIQ中只利用存储节点构建成索引的叶子节点，与利用所有节点建成的索引相比，其维护的节点数量少，索引的构建成本降低。同时SIQ采用数据属性为空间索引内容，有效地对监测数据进行多维属性的范围查询。仿真结果表明，与较成熟的DD算法和GHT算法相比，SIQ方法能克服泛洪查询所引起的高通信复杂度。


引言
     无线传感器网络是由一组传感器以Ad-Hoc的方式构成的无线网络，其目的是协作地感知、采集和处理网络覆盖地理区域中被感知对象的信息，并发布给观察者。因为信息以数据方式体现，所以WSN的主要任务之一是利用传感节点查询数据。当前WSN的数据查询方案分为以下三种：基于外部存储的数据查询方案，基于本地存储的数据查询方案以及基于数据中心的数据查询方案。
     基于外部存储的数据查询方案将外部中央处理器作为存储处理节点，优点是查询数据的通信复杂度为0，但中央处理器易成为整个环境的瓶颈并引起单点故障，导致能量消耗不均匀等问题，难以满足大尺度的监测需要。基于本地存储的数据查询方案，其数据存储不产生通信开销，但查询时须首先在整个网络中洪泛访问所有存储点，当网络规模庞大或者查询频率高时，将不可避免的产生巨大的通信量，降低能源有效性。A，B算法都采用了基于数据中心方案的查询方法，把同类型数据采用哈希索引算法存储在同一个地理位置，其优点是查询快捷，但是会产生巨大的数据存储开销，从而导致该地理位置成为一个的热点，要处理大量的通信，导致发生单点故障的频率较高。
     通过对现有数据查询方案的分析并结合网络中局部范围内节点往往监测的数据相似这一特点，本文提出将整个网络按地理位置划分区域，采用局部数据聚集存储的数据存储模型，避免了将同种数据发送至一个存储点存储所造成的通信开销。通过对空间索引[8-9]的研究发现，大规模的网络可以采用空间索引来加速聚类。因此在数据存储模型基础上，又进一步提出一种基于数据属性空间索引的数据查询方法，使查询操作能够快速访问操作对象，从而提高查询和转发效率。
1 数据存储模型设计
1.1 基本存储结构模型
   在数据模型中，当节点监测到目标事件后周期性的产生监测数据，根据保存的监测数据的元数据属性标志符，以及通信范围，采用局部聚类方式构建属性组，将监测到元数据标志符发送并保存至所属属性组的存储节点上。
　　图1描述了一个存储小组对数据的聚集作用。组内成员采用局部聚类方式，采取地域邻近原则和所监测数据类型的邻近原则，聚集成为一个存储小组。由SN充当存储小组的存储节点，并维护该存储小组。
1.2 分组构建
     节点一旦监测到目标便会产生监测数据，初始阶段，监测内容存储在节点自身，该节点即成为SN。随着时间推移，临近范围内有更多节点将监测到相同类型数据。紧接着监测到该类型的数据节点将根据自己邻居节点列表中是否有SN，以及自己是否具备成为SN的条件，来选择自己是加入一个已有的存储小组中，还是自己成为一个SN。
     若选择加入已有的存储小组中，需要通过匹配度判断。根据数据匹配率计算出与SN之间的距离，并根据此距离来衡量与SN的匹配度，只有匹配度满足阈值要求，同时在彼此通信范围之内的节点，才能成为一个存储组中的成员。
     构建存储分组也就是要解决节点如何加入网络、如何获取邻居的问题，SN如何更新资源信息的问题。一个新节点加入存储分组的步骤为：    
　　(1)新节点查询邻接表的资源信息；
　　(2)若邻接表中存在有SN，则将自身所监测到的数据属性与SN的存储属性相比较；
　　(3)若存在有相匹配的SN，则挑选其中一个SN作为自身监测信息的存储节点，并将其余SN作为备选SN列入自身的备选存储节点表中；若没有相匹配的SN，则转向(5)；
　　(4)新节点向SN发送存储请求报文，得到允许后，将自身监测到的数据传送至SN，若未得到允许，则在备选的存储节点表中继续挑选相匹配的SN，若选择成功，则重复(4)的操作，若不成功，则转向(7)；
　　(5)节点将自身设置为存储节点，并向邻居节点发送广播，报告自己的存储节点属性以及所存储的数据属性；
　　(6)邻居节点受到广播报文之后，将自己的邻接表资源信息更新；
　　(7)结束。
    SN更新节点信息时，首先SN接收新节点的存储请求报文，若允许则接收新节点的监测数据，并更新自己的资源信息表，将新节点记录在自己的下属节点表中；不允许则返回拒绝报文。
     由于相邻节点所产生的监测数据往往记录的是同一事件，属于同一被监测目标在一段时间内的连续情况，因此采用上述构建分组方法能够形成数据的聚类；由于邻近监测存在极大的冗余，需要再作相应的冗余处理，在转存的过程中，可采取一定的数据融合算法进行数据的融合。
2 基于空间索引的数据查询
     为了更有效地对无线传感器网络监测到的数据进行查询和分发，文中设计了基于空间索引的数据查询机制算法。
     R树采用基于空间对象的最小外接矩形反映空间对象的空间特性，从而加速空间对象的定位过程。它所有的索引记录都存放在叶子节点中，叶子节点中包含数据项，一个数据项是由<MBR，RID>对组成的，RID标识一个对象，MBR是包含这个对象的最小外接矩形。非叶子节点包含的索引项的形式为<MBR，指向子节点的指针>，在非叶子节点N上的最小外接矩形是包含所有以节点N为子树根的所有数据对象的区域。R树结构如图2所示。
     基于R数原理，若给定某一数据对象的属性区域，采用类似的索引结构，也可以查询在该属性区域内的对象。因此在不同应用场景中，对数据对象采用不同的最小外接"矩形"表示，可以进行各种多维的范围查询。这里"矩形"已经不仅仅局限在地理区域的矩形框，也可以是数据任何方面属性的抽象域范围。
     SIQ的设计思想是：由各存储节点充当索引树(Sensor Tree，ST)的叶子节点，共同维护一棵索引树，将每个SN上所存储的元数据信息按照插入规则插入到索引树中，查询时，由终端用户向索引层节点发出查询请求，索引找到符合查寻范围的对象，然后向该对象所包含的所有SN转发查询数据包，再由相应的SN将所需要的数据信息反馈给终端用户。其间，所有底层通信均调用GPSR(Greedy Perimeter Stateless Routing)路由协议完成。
　　ST的数据结构模型中，每个节点用一个结构体描述，包括节点标志符，标识节点属于非叶子节点还是叶子节点；每个节点包含单元数目，标识该节点包含的子节点数目；节点的层次；节点的分枝。其中，每个叶子节点的记录对应一个数据对象，数据对象可以描述为下面的形式：
　　其中Rect表示一个N维的最小属性边界框，表示对应对象的属性值的最小范围，Recti表示在第i维属性边界框。
     非叶子节点中每个记录对应下一个子节点，可以描述为<Rect，Child>形式。其中Rect表示节点的所有记录代表的最小属性边界框的最小N维属性边界框。Child表示指向子节点的指针。
2.4 Sensor Tree的构建与动态维护
2.4.1 Sensor Tree中索引对象的插入
     当节点监测到新的数据对象时，要向ST中插入与其对应的索引记录I时。描述算法如下：(其中R为根节点，I为索引纪录，M为阀值，L为叶子节点)：
　　(1)调用叶子节点选择算法选择合适的叶子节点L存放I；
　　(2)若L中单元数小于M，加入I；
　　(3)若L中单元数大于M，调用节点分裂算法分裂节点，对分裂节点调用树的调整算法进行调整；
　　(4)若R中单元个数大于M，分裂R，并生成一个新节点作为新根节点，R分裂成的两个节点作为其子节点。此时树层次增加1；
　　(5)若R中单元个数小于M，返回。
     
     索引项删除算法：从ST中删除索引项I。
     算法描述：
(1)调用叶子节点的寻找算法寻找存放I的叶子节点L，没有找到则转向(4)；
(2)从L中删去I，调用树的压缩算法；
(3)若R只有一个孩子，则让该孩子节点成为新根；
(4)返回。
　　
　　搜索算法：
　　(1)若R不是叶子节点，检查R中每一索引项I所代表的最小属性边界框是否和Rect相重叠。对于相重叠的项，则对以I中子节点指针所指的节点为根的子树调用搜索算法；
　　(2)若R是叶子节点，检查R中的每一项I是否和Rect相重叠，若是，将I加入结果集中。
     下面通过一个例子描述SIQ的查询过程。
     例如在交通监控环境中，无线传感器网络负责监控某一路段上车辆超速情况，终端节点需要获得超速车辆的信息，包括其车速V和所在路段位置X。网络中的传感节点将采集到的车辆信息存储在存储节点中以后，由存储节点向索引节点报告情况。存储节点中的新数据对象按照索引插入算法插入到ST中，其中对象包括二维属性车速V和路段位置X，该对象的索引项中需要维护的最小数据属性边界框包括车速的边界范围，以及路段位置的边界范围。终端节点发出查询超速车辆时，就可以通过选择车速范围，通过对ST搜索，找到在指定车速范围内的对象，获得超速对象车辆信息。
3.1 查询频率对查询的影响
	在查询阶段采用不同的查询频率，分别计算其网络通信复杂度。总通信复杂度表示整个网络中产生的通信量总和；热点通信复杂度表示热点区域产生的最大的通信量。实验总节点数目设置为300，结果如图3所示。
	图3(a)表示网络中整体通信复杂度随平均查询频率的变化情况，图3(b)表示网络中热点通信复杂度随平均查询频率的变化情况。三种算法在平均查询频率增大时，网络整体通信复杂度和热点通信复杂度都呈下降趋势。DD的网络整体通信复杂度最高，这是由于它采用泛洪查询的方式在全网内转发消息，造成通信开销大。GHT算法和SIQ算法的网络整体通信复杂度比较接近，约占DD算法的60% 。在查询频率较低的情况下，SIQ算法体现出优于GHT算法的性能。GHT算法的热点通信复杂度远远高于另外两种算法，这是由于它采用将同种类型数据存放在一个节点上，造成该节点成为网络的热点。
3.2 网络规模对查询的影响
     为分析网络规模的可扩展性，在查询阶段采用不同的节点数，分别计算其网络通信复杂度，结果如图4所示。
     图4(a)表示了网络中整体通信复杂度随网络规模的变化情况，图4(b)表示了网络中热点通信复杂度随网络规模的变化情况。三种算法在网络规模扩大时，总体通信复杂度呈上升趋势，热点通信复杂度呈轻微下降趋势。DD的网络整体通信复杂度最高，这是由于Directed Diffusion的查询分组采用泛洪的方式，当网络中节点数目增加时，其查询分组也会大量增加，导致通信复杂度的升高。SIQ算法的通信复杂度略低，这是由于采用的索引机制在节点数目增大时能减轻由于泛洪查询引起的开销。
